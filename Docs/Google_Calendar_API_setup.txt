"""
GOOGLE CALENDAR API - COMPLETE SETUP GUIDE
===========================================

This guide shows you how to set up Google Calendar API access for your smart mirror.

STEP-BY-STEP SETUP:
==================

PART 1: CREATE GOOGLE CLOUD PROJECT (One-time setup)
-----------------------------------------------------
1. Go to: https://console.cloud.google.com/
2. Create a new project (e.g., "SmartMirrorCalendar")
3. Enable Google Calendar API:
   - Go to "APIs & Services" → "Library"
   - Search for "Google Calendar API"
   - Click "Enable"

PART 2: CREATE OAUTH CREDENTIALS (One-time setup)
-------------------------------------------------
1. Go to "APIs & Services" → "Credentials"
2. Click "Create Credentials" → "OAuth client ID"
3. If prompted, configure OAuth consent screen:
   - Choose "External" (for personal use)
   - App name: "Smart Mirror"
   - User support email: your email
   - Add your email to test users
   - Save
4. Create OAuth client ID:
   - Application type: "Desktop app"
   - Name: "Smart Mirror Desktop"
   - Click "Create"
5. Download the JSON file
6. Rename it to: credentials.json
7. Place it in your project folder

PART 3: INSTALL REQUIRED PACKAGES
----------------------------------
Run this command:
    pip install google-auth google-auth-oauthlib google-auth-httplib2 google-api-python-client

PART 4: FIRST RUN - AUTHORIZE THE APP
--------------------------------------
1. Run: python google_calendar_api.py
2. A browser window will open
3. Sign in with your Google account
4. Click "Allow" to grant calendar access
5. A token.json file will be created (stores your authorization)

PART 5: SUBSEQUENT RUNS
------------------------
After the first authorization, the app will use token.json automatically.
No browser window will open - it just works!

IMPORTANT FILES:
----------------
credentials.json  - Your app's OAuth credentials (from Google Cloud)
token.json        - Your personal authorization token (created on first run)
                    This file gives access to YOUR calendar

SECURITY NOTES:
---------------
- Add both files to .gitignore (already done)
- credentials.json identifies your app
- token.json contains your personal access
- Never share these files publicly
- token.json expires and refreshes automatically

COMPARISON TO .ICS FILES:
-------------------------

Local .ics files:
✓ Simple, no setup
✓ Private by default
✗ Manual updates required
✗ No real-time sync

Google Calendar API:
✓ Real-time access
✓ Auto-updates
✓ Can access multiple calendars
✓ Can read tasks from Google Tasks
✗ More complex setup (one-time)
✗ Requires internet connection

TROUBLESHOOTING:
----------------
Error: "invalid_grant" or "Token has been expired or revoked"
Fix: Delete token.json and run again to re-authorize

Error: "API has not been enabled"
Fix: Go to Google Cloud Console and enable Calendar API

Error: "Access blocked: This app's request is invalid"
Fix: Add your email to test users in OAuth consent screen
